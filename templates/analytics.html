{% extends "layout.html" %}
{% block title %}Analytics{% endblock %}
{% block content %}
<div id="analytics-container" class="container mt-5" data-username="{{ username }}">
  <h1 style="color:#10b981;">Analytics</h1>

  <!-- Server Status -->
  <div class="card mb-4 bg-dark text-light border-secondary">
    <div class="card-header bg-dark text-light border-secondary" style="color:#a5b4fc;">Server Status</div>
    <div class="card-body" id="server-status">
      <span>Loading server status...</span>
    </div>
  </div>

  <!-- User Study Stats -->
  <div class="card mb-4 bg-dark text-light border-secondary">
    <div class="card-header bg-dark text-light border-secondary" style="color:#a5b4fc;">Your Study Stats</div>
    <div class="card-body" id="user-stats">
      <ul class="list-group bg-dark rounded mb-3" style="margin-bottom:0;">
        <li class="list-group-item bg-dark text-light border-secondary">
          <strong>Total Study Sessions:</strong> <span id="total-sessions">Loading...</span>
        </li>
        <li class="list-group-item bg-dark text-light border-secondary">
          <strong>Average XP per Session:</strong> <span id="average-xp">Loading...</span>
        </li>
      </ul>
      <div>
        <strong>Recent Sessions:</strong>
        <ul id="recent-sessions" class="list-group bg-dark rounded mt-2"></ul>
      </div>
    </div>
  </div>

  <!-- Charts Section -->
  <div class="mb-3">
    <button class="btn btn-outline-info btn-sm me-2" id="filter-day">Day</button>
    <button class="btn btn-outline-info btn-sm me-2" id="filter-week">Week</button>
    <button class="btn btn-outline-info btn-sm" id="filter-month">Month</button>
  </div>
  <div class="card mb-4 bg-dark text-light border-secondary">
    <div class="card-header bg-dark text-light border-secondary" style="color:#a5b4fc;">Study Progress (Charts)</div>
    <div class="card-body">
      <canvas id="xpChart" height="100"></canvas>
      <canvas id="xpBarChart" height="100" class="mt-4"></canvas>
      <div id="no-xp-data" class="text-warning mt-2" style="display:none;">No XP data available for chart.</div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='js/analytics.js') }}"></script>
{% endblock %}