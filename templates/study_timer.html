{% extends "layout.html" %}
{% block title %}Study Timer{% endblock %}
{% block content %}
<div class="container-fluid d-flex align-items-center justify-content-center" style="min-height:100vh;">
  <div id="study-timer"
       class="d-flex flex-column align-items-center justify-content-center gap-4 shadow-lg rounded p-5 w-100"
       style="background-size:cover; background-position:center; height:90vh;">
    <!-- Big Emoji -->
    <div class="text-center" style="font-size:4rem;">ðŸ“šâœ¨</div>
    <!-- Rotating Motivational Quote -->
    <div id="motivational-quote" class="text-center text-light mb-2" style="font-style:italic; font-size:1.5rem;">
      "Stay focused and never give up!"
    </div>
    <!-- Session Goal Selector -->
    <div class="mb-2 text-center w-100">
      <label for="session-goal" class="form-label text-light">Session Goal (minutes):</label>
      <select id="session-goal" class="form-select w-auto d-inline-block">
        <option value="25">25</option>
        <option value="50">50</option>
        <option value="90">90</option>
      </select>
    </div>
    <!-- Progress Bar -->
    <div class="w-75">
      <div class="progress" style="height: 2rem;">
        <div id="session-progress" class="progress-bar bg-success" role="progressbar" style="width: 0%; font-size:1.2rem;"></div>
      </div>
    </div>
    <!-- Background Selector -->
    <div class="mb-2 text-center w-100">
      <label for="bg-select" class="form-label text-light">Choose Background:</label>
      <select id="bg-select" class="form-select w-auto d-inline-block">
        <option value="nature.png">Nature</option>
        <option value="ocean.png">Oceans</option>
        <option value="space.png">Space</option>
        <option value="black.png">Black</option>
        <option value="study.png">Study</option>
      </select>
    </div>
    <!-- Timer Display -->
    <div id="timer-display" class="display-1 text-light mb-3 text-center" style="font-size:5rem;">00:00:00</div>
    <!-- Timer Controls -->
    <div class="d-flex flex-wrap justify-content-center gap-4 w-100">
      <button id="start-btn" class="btn btn-success btn-lg">Start</button>
      <button id="pause-btn" class="btn btn-warning btn-lg" disabled>Pause</button>
      <button id="reset-btn" class="btn btn-danger btn-lg" disabled>Reset</button>
      <button id="save-btn" class="btn btn-primary btn-lg" disabled>Save</button>
      <button id="fullscreen-btn" class="btn btn-secondary btn-lg">Fullscreen</button>
    </div>
    <!-- Achievements Preview (static example) -->
    <div class="mt-3 text-center">
      <span class="badge bg-success fs-5">ðŸŽ‰ First Session</span>
      <span class="badge bg-info fs-5">ðŸ”¥ Streak</span>
    </div>
    <!-- Back to Dashboard -->
    <a href="{{ url_for('dashboard') }}" class="btn btn-outline-light mt-3 btn-lg">Back to Dashboard</a>
  </div>
</div>
{% endblock %}
{% block scripts %}
<script src="{{ url_for('static', filename='js/study_timer.js') }}"></script>
<script>
// Rotating motivational quotes
const quotes = [
  "Stay focused and never give up!",
  "Small steps every day lead to big results.",
  "Youâ€™re closer than you think!",
  "Consistency is the key to success.",
  "Believe in yourself and all that you are."
];
let quoteIdx = 0;
setInterval(() => {
  quoteIdx = (quoteIdx + 1) % quotes.length;
  document.getElementById('motivational-quote').textContent = quotes[quoteIdx];
}, 7000);

// Progress bar logic
const progressBar = document.getElementById('session-progress');
const sessionGoalSelect = document.getElementById('session-goal');
let sessionGoal = parseInt(sessionGoalSelect ? sessionGoalSelect.value : 25, 10);

if (sessionGoalSelect) {
  sessionGoalSelect.addEventListener('change', function() {
    sessionGoal = parseInt(this.value, 10);
    updateProgressBar();
  });
}

function updateProgressBar() {
  if (progressBar && window.elapsedSeconds !== undefined) {
    const percent = Math.min(100, (window.elapsedSeconds / (sessionGoal * 60)) * 100);
    progressBar.style.width = percent + "%";
    progressBar.textContent = Math.floor(percent) + "%";
  }
}

// Hook into timer update (study_timer.js should call updateProgressBar after updateDisplay)
window.updateProgressBar = updateProgressBar;
</script>
{% endblock %}